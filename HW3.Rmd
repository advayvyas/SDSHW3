---
title: 'Homework #3'
author: "Advay Vyas"
date: 2/12/25
output:
  pdf_document:
    toc: true
urlcolor: blue
linkcolor: red
---

```{r global_options, echo=FALSE}
knitr::opts_chunk$set(fig.height=4, fig.width=6, fig.align = "center", warning=FALSE, echo=FALSE, tidy=TRUE, tidy.opts=list(width.cutoff=60))
```

------------------------------------------------------------------------

```{r, results='hide', warning=FALSE, message=FALSE}
# loading libraries
library(tidyverse)
library(ggplot2)
library(lubridate)
library(sas7bdat)
library(rvest)
library(stringr)
library(boot)
library(mosaic)
```
# Introduction
I'm Advay Vyas, EID: av37899, and this is my submission for SDS 315 Statistical Thinking Homework #3. The GitHub repository for my code is at this [link](https://github.com/advayvyas/SDSHW3).

# Problem 1
```{r}
gas = read.csv("GasPrices.csv")
```

## Theory A
```{r, cache=TRUE, message=FALSE}
gasA_CI = confint((do(10000)*diffmean(Price~Competitors, data=mosaic::resample(gas)))$diffmean, level = 0.95)
```
Gas stations charge more if they lack direct competition in sight.

```{r}
gasA_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```

## Theory B
```{r, cache=TRUE, message=FALSE}
gasB_CI = confint((do(10000)*lm(Price~Income, data=mosaic::resample(gas))), level = 0.95)
```
The richer the area, the higher the gas prices.

Used 10,000 to multiply by here.
```{r}
gasB_CI[2,c(2,3)] %>% mutate(across(everything(), ~ . * 10000)) %>% 
  round(4) %>%  rename('2.5%' = 'lower', '97.5%' = `upper`) %>% knitr::kable(row.names = FALSE)
```

## Theory C
```{r, cache=TRUE, message=FALSE}
gasC_CI = confint((do(10000)*diffmean(Price~Stoplight, data=mosaic::resample(gas)))$diffmean, level = 0.95)
```
Gas stations at stoplights charge more.

```{r}
gasC_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```

## Theory D
```{r, cache=TRUE, message=FALSE}
gasD_CI = confint((do(10000)*diffmean(Price~Highway, data=mosaic::resample(gas)))$diffmean, level = 0.95)
```
Gas stations with direct highway access charge more.

```{r}
gasD_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```

## Theory E
```{r}
gas$Shell = gas$Name == "Shell"
```

```{r, cache=TRUE, message=FALSE}
gasE_CI = confint((do(10000)*diffmean(Price~Shell, data=mosaic::resample(gas)))$diffmean, level = 0.95)
```
Shell charges more than all other non-Shell brands.m

```{r}
gasE_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```


# Problem 2
```{r}
cars = read.csv("sclass.csv")
```

## Part A
```{r}
carsA = cars %>% filter(year == 2011 & trim == '63 AMG') 
```

```{r, cache=TRUE, message=FALSE}
carsA_CI = confint((do(10000)*mean(mosaic::resample(carsA)$price)), level = 0.95)
```

```{r}
carsA_CI[1,c(2,3)] %>% round(4) %>%  rename('2.5%' = 'lower', '97.5%' = `upper`) %>% knitr::kable(row.names = FALSE)
```

## Part B
```{r}
carsB = cars %>% filter(year == 2014 & trim == '550') %>% mutate(black = (color == "Black"))
```

```{r, cache=TRUE, message=FALSE}
carsB_CI = confint((do(10000)*prop(~black, data=mosaic::resample(carsB))), level = 0.95)
```

```{r}
carsB_CI[1,c(2,3)] %>% round(4) %>%  rename('2.5%' = 'lower', '97.5%' = `upper`) %>% knitr::kable(row.names = FALSE)
```

# Problem 3
```{r}
shows = read.csv("nbc_pilotsurvey.csv")
```

## Part A
```{r}
showsA = shows %>% filter(Show == 'Living with Ed' | Show == 'My Name is Earl')
```

```{r, cache=TRUE, message=FALSE}
showsA_CI = confint((do(10000)*diffmean(Q1_Happy~Show, data=mosaic::resample(showsA)))$diffmean, level = 0.95)
```

```{r}
showsA_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```

## Part B
```{r}
showsB = shows %>% filter(Show == "The Biggest Loser" | Show == "The Apprentice: Los Angeles")
```

```{r, cache=TRUE, message=FALSE}
showsB_CI = confint((do(10000)*diffmean(Q1_Annoyed~Show, data=mosaic::resample(showsB)))$diffmean, level = 0.95)
```

```{r}
showsB_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```

## Part C
```{r}
showsC = shows %>% filter(Show == "Dancing with the Stars") %>% mutate(high_rating = (Q2_Confusing >= 4))
```

```{r, cache=TRUE, message=FALSE}
showsC_CI = confint((do(10000)*prop(~high_rating, data=mosaic::resample(showsC))), level = 0.95)
```

```{r}
showsC_CI[1,c(2,3)] %>% round(4) %>%  rename('2.5%' = 'lower', '97.5%' = `upper`) %>% knitr::kable(row.names = FALSE)
```

# Problem 4
```{r}
ebay = read.csv("ebay.csv")

ebay = ebay %>% mutate(ratio = (rev_after/rev_before))
```

```{r, cache=TRUE, message=FALSE}
ebay_CI = confint((do(10000)*diffmean(ratio~adwords_pause, data=mosaic::resample(ebay)))$diffmean, level = 0.95)
```

```{r}
ebay_CI %>% round(4) %>% knitr::kable(row.names = FALSE)
```